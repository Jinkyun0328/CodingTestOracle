SELECT EXTRACT (YEAR from B.SALES_DATE) as YEAR,
        EXTRACT (MONTH from B.SALES_DATE) as MONTH,       
        A.GENDER, COUNT(DISTINCT B.USER_ID) AS USERS
FROM USER_INFO A, ONLINE_SALE B
WHERE A.USER_ID = B.USER_ID
    AND A.GENDER IS NOT NULL
GROUP BY EXTRACT (YEAR from B.SALES_DATE),
            EXTRACT (MONTH from B.SALES_DATE), 
            A.GENDER
ORDER BY YEAR, MONTH, A.GENDER
;